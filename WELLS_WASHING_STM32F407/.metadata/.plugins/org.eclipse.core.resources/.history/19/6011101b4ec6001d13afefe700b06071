/*
 * motor.c
 *
 *  Created on: Mar 19, 2023
 *      Author: ADMIN
 */


#include "main.h"
#include "stdint.h"
#include "motor.h"

extern TIM_HandleTypeDef htim1;
extern TIM_HandleTypeDef htim2;
_motor_typedef x_motor,z_motor;

void x_mt_set_dir(uint32_t cur_pos,uint32_t next_pos){
//	x_motor.current_dir = dir;
	if(cur_pos < next_pos){
		HAL_GPIO_WritePin(X_MOTOR_DIR_GPIO_Port, X_MOTOR_DIR_Pin, dir);
		htim2.Instance->CR1
	}

}

void x_mt_move_to_pos(uint32_t pos){

}

void x_mt_start(){
	HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_1);
}

void x_mt_stop()
{
	HAL_TIM_PWM_Stop(&htim1, TIM_CHANNEL_1);
}

void x_mt_move_to_pos(uint32_t dir){
	x_motor.next_pos = dir;
	x_motor.current_pos = htim2.Instance->CNT;
	HAL_TIM_PWM_Stop(&htim1, TIM_CHANNEL_1);
	if(x_motor.next_pos > x_motor.current_pos){
		x_mt_set_dir(DIR_FORWARD);
	}
	else
	{
		x_mt_set_dir(DIR_BACKWARD);
	}
}
